# 미션 알람 서비스 깻냥 프로젝트

<div className="lg:hidden mb-6 mt-6 rounded-lg border border-slate-200 bg-slate-50 p-4 shadow-sm dark:border-slate-700 dark:bg-slate-900">
  <p className="mb-2 font-bold">목차 바로가기</p>
  <ul className="space-y-1 text-[15px]">
    <li><a className="text-blue-600 no-underline hover:underline dark:text-blue-300" href="#1-프로젝트-개요">🎯 프로젝트 개요</a></li>
    <li><a className="text-blue-600 no-underline hover:underline dark:text-blue-300" href="#2-담당-역할-및-기여">🧑‍💻 역할 및 기여</a></li>
    <li><a className="text-blue-600 no-underline hover:underline dark:text-blue-300" href="#3-사용-기술-및-이유">🛠 사용 기술</a></li>
    <li><a className="text-blue-600 no-underline hover:underline dark:text-blue-300" href="#4-구현-사항">⚙️ 구현 사항</a></li>
    <li><a className="text-blue-600 no-underline hover:underline dark:text-blue-300" href="#5-프로젝트-성과-및-결과">⚙️ 프로젝트 성과 및 결과</a></li>
    <li><a className="text-blue-600 no-underline hover:underline dark:text-blue-300" href="#6-문제-및-해결방법">🧩 문제 해결</a></li>
  </ul>
</div>

<div className="mt-3 flex flex-wrap items-center gap-2">
  <span className="inline-flex items-center rounded-md border border-sky-100 bg-sky-50 px-3 py-1 text-sm font-medium text-sky-800 dark:border-sky-900 dark:bg-sky-900/40 dark:text-sky-100">📅 2024.06 ~ 2024.07</span>
  <span className="inline-flex items-center rounded-md border border-violet-100 bg-violet-50 px-3 py-1 text-sm font-medium text-violet-800 dark:border-violet-900 dark:bg-violet-900/40 dark:text-violet-100">👥 6명</span>
  <span className="inline-flex items-center rounded-md border border-emerald-100 bg-emerald-50 px-3 py-1 text-sm font-medium text-emerald-800 dark:border-emerald-900 dark:bg-emerald-900/40 dark:text-emerald-100">🛠 Spring Boot · FCM · Native Alarm · React</span>
  <span className="inline-flex items-center rounded-md border border-amber-100 bg-amber-50 px-3 py-1 text-sm font-medium text-amber-800 dark:border-amber-900 dark:bg-amber-900/40 dark:text-amber-100">🎯 알림/스케줄링 · WebRTC 연동</span>
</div>

프로젝트 개요: WebRTC와 백엔드 알림 파이프라인(FCM+네이티브 알람)으로 정해진 시간에 미션을 실행·검증하게 만드는 알람 서비스입니다.

![Group 16.png](https://assets.cvcvcx9.org/images/kkatnyang/aefa2422-7b2f-4494-851c-1ba49be8c6bd.png)

<aside className='mt-2'>
>💡
영상통화로 상대방이 미션을 수행하는지 확인하고, 투표하세요! 혼자서 진행하는 경우에는 AI가 직접 성공과 실패를 판정합니다.

</aside>

[https://youtube.com/shorts/potFdbd8nD8?feature=share](https://youtube.com/shorts/potFdbd8nD8?feature=share)

### **1. 프로젝트 개요**

- **목표:**
    
    스마트폰으로 미션을 수행하고, 팀과 함께 실시간으로 공유하며, 투표를 통해 미션 결과를 평가하여 사용자가 목표 시간에 꼭 일어나도록 돕는 앱 개발.
    
- **배경:**
    
    기상 알람이 효과적이지 않거나 의지가 부족한 사람들을 위해, 팀원들과 함께 미션을 수행하며 상호 격려와 평가를 통해 아침 일어나는 습관을 형성할 수 있도록 기획된 프로젝트.
    
- **주요 기능:**
    - 매일 아침 집에서 수행 가능한 미션 자동 선정.
    - 실시간 단체 영상 통화를 통한 미션 진행 공유 및 확인.
    - 팀원들이 미션 결과를 투표로 판정.
    - 미션 시간이 되면 알림 제공.

---

### **2. 담당 역할 및 기여**

- **역할:** 프론트엔드 & 알림 연동
- **기여:**
    - **알림 백엔드 연동:** Spring Boot 알림 API + FCM 데이터 메시지 연동, 알람 재등록/취소 플로우 구현
    - **네이티브 알람 이중화:** 로컬 알람과 FCM 재알림 이중화 UX 설계
    - **WebRTC 방 연결:** 미션 시간에 맞춰 방 입장/초대 흐름 구현, 알림 딥링크 → 방 진입
    - **미션 스케줄 관리:** 사용자 맞춤 시간/반복 설정 UI·상태 관리, 초대/참여 흐름

---

### **3. 사용 기술 및 이유**

- **Spring Boot + FCM**: 알림 API, 재알림(FCM) 백업, 멱등/취소 처리
- **Native Alarm (AlarmManager/WorkManager)**: 절전·제조사 제한 환경에서도 정시 알람 보장
- **React**: WebRTC 튜토리얼(OpenVidu)과 빠른 UI 구현
- **WebRTC**: 실시간 미션 검증(영상통화)

---

### **4. 구현 사항**

- **알림 이중화 플로우:** 네이티브 알람을 1차, 실패 시 FCM 재알림(딥링크→방 입장)으로 동작
- **반복 스케줄 확장:** 요일별 반복(월~금 등) 지원을 위해 알람 라이브러리 포크·커스텀
- **미션 방 연결:** 알람 → 딥링크 → WebRTC 방 자동 연결, 초대/참여 상태 갱신
- **시간 변경 시 재등록:** 알람 재설정 시 기존 스케줄 취소 후 재등록, 최신 설정만 유지

### ERD
![깻냥.png](https://assets.cvcvcx9.org/images/kkatnyang/깻냥.png)

---

### **5. 프로젝트 성과 및 결과**

- **성과:**
    - OAuth2.0 및 WebRTC 기술을 성공적으로 적용하여 실시간 미션 수행 환경 제공.
    - React와 Flutter 기반으로 빠른 개발과 사용자 친화적인 인터페이스 구현.
    - FCM 및 네이티브 알람 기능을 통해 사용자 편의성 극대화.
- **결과:**
    
    프로젝트의 모든 주요 기능이 계획에 따라 동작하도록 구현.
    

---

### 6. 문제 및 해결방법

### 🔔 문제 1: 알람 중복·지연 발생 (정확한 기상 시각 보장)

**상황:**  
FCM 푸시와 로컬 알람을 모두 써도, 절전 모드/제조사 커스텀 OS에서 알람이 늦게 울리거나 중복으로 울리는 문제가 있었음. 핵심 목표(정해진 시간에 깨우기)에 치명적.

**해결 방법:**
1. **네이티브 알람 우선, FCM은 보조로 분리**  
   - 기기 내 AlarmManager/WorkManager를 1차로 사용해 정확도 확보  
   - 실패 시 서버가 FCM 데이터 메시지로 재알림 발송
2. **알람 재등록 시 이전 스케줄 정리**  
   - 시간 변경/반복 설정 시 기존 PendingIntent 취소 후 재등록  

**결과:**  
중복·지연 알람 제거, 기상 알림 정확도 확보.

---

### ⏱️ 문제 2: 1주일 반복 알람 지원 라이브러리 부재

**상황:**  
기존 알람 라이브러리에 주간 반복(예: 월~금 기상) 기능이 없어 사용자가 원하는 반복 패턴을 설정할 수 없었음.

**해결 방법:**
- 오픈소스 알람 라이브러리를 포크/커스터마이즈해 요일별 반복 스케줄링 기능 추가  
- 내부 포맷으로 저장해 AlarmManager 재등록 시 요일 정보를 반영

**결과:**  
월~금/주말 전용 등 반복 알람 지원, 사용성 개선.

---

### 📱 문제 3: 영상통화 미션 직전 알림이 느리게 도착

**상황:**  
미션 방 입장 알림이 늦어 영상통화 시작 시점이 어긋남.

**해결 방법:**
- 미션 시각 1~2분 전에 네이티브 알람을 먼저 울리게 하고, FCM은 방 입장 토큰 전달용으로만 사용  
- 네이티브 알람 터치 시 바로 WebRTC 방으로 진입하도록 딥링크 연결

**결과:**  
영상통화 시작 시간 준수, 미션 진행 동기화 개선.
