# OTT추천 서비스개발 선택의왕 프로젝트

기간 및 인원: 2024.05 ~ 2024.05 (인원 2명)
기술스택: Django, JavaScript, Vue.js
담당역할: 팀장, 추천 도메인 및 유저 도메인, ERD작성, 외부API 연결
프로젝트 개요: OTT를 새로 가입하고 싶은 유저에게, 유저선택기반으로 OTT를 추천하는 서비스를 제공하는 프로젝트입니다.

![image.png](https://assets.cvcvcx9.org/images/kingOfChoice/image.png)

<aside>
> 💡 유저기반 OTT추천서비스 선택의왕

</aside>

### **1. 프로젝트 개요**

- **목표:**
    
    사용자가 선호하는 영화와 장르를 기반으로 최적의 OTT 플랫폼을 순위별로 추천해주는 서비스 개발.
    
- **배경:**
    
    다양한 OTT 플랫폼 중 어떤 서비스가 사용자 취향에 맞는지, 또는 가장 많은 영화 콘텐츠를 제공하는지 파악하기 어려운 사용자들을 위해 맞춤형 추천 서비스를 제공하기 위해 기획된 프로젝트.
    
- **주요 기능:**
    - 사용자가 선호하는 영화와 OTT 선택.
    - 선택 기반으로 OTT 순위 추천 제공.
    - ChatGPT 챗봇을 활용해 선호 장르 기반 영화 및 추가 추천 제공.

---

### **2. 담당 역할 및 기여**

- **역할:**
    
    팀장, 영화 및 추천 도메인, 유저 도메인 개발 담당.
    
- **기여:**
    - **ERD 작성:** 데이터베이스 설계.
    - **목업 작성:** 서비스 인터페이스 기획 및 설계.
    - **도메인 개발:** 영화, 추천 및 유저 도메인 설계 및 구현.
    - **OAuth2 로그인 기능 구현:** 카카오 로그인 및 로그아웃 기능 개발.
    - **추천 챗봇 개발:** ChatGPT를 활용해 영화 장르 취향 기반 추천 기능 구현.

---

### **3. 사용 기술 및 이유**

- **사용 기술:**
    - **Vue.js:** 프론트엔드 인터페이스 구축.
    - **Bootstrap:** 빠르고 효율적인 UI 디자인.
    - **Django:** 백엔드 프레임워크로 사용, 빠른 API 개발 가능.
- **선택 이유:**
    - 팀원들의 기술 스택과 짧은 개발 기간을 고려해 가장 익숙한 기술을 선택하여 효율성을 높임.

---

### **4. 구현 사항**

- **OTT 및 영화 추천:**사용자가 선택한 영화와 OTT 데이터를 기반으로 가입할 만한 OTT를 추천.
- **외부 데이터 활용:**OpenAPI를 통해 영화 및 OTT 데이터를 수집, 데이터베이스에 저장한 뒤 추천 로직 구현.
- **추천 로직 개발:**사용자의 취향과 데이터를 분석해 맞춤형 OTT 플랫폼 순위 추천.
- **챗봇 기능:**ChatGPT를 통해 사용자가 선택한 영화 및 장르를 기반으로 개인화된 영화 추천 제공.

---

### **5. 문제 해결 사례**

### 📦 문제 1: 외부 API에서 수집한 영화 데이터의 불일치 및 누락

**상황:**

OpenAPI를 통해 영화 정보를 주기적으로 수집했지만,

OTT별 제공 여부나 영화 장르 정보가 누락되어 추천 결과가 비정확하게 나타남.

**원인:**

- 일부 영화의 메타데이터(`genre`, `ott_provider`)가 비어 있거나 중복 저장됨
- 외부 API 요청 시 rate limit으로 인해 일부 응답 누락 발생

**해결 방법:**

1. **데이터 정제 파이프라인 추가**
    - 수집된 데이터를 Django ORM으로 임시 저장 후
        
        null 값 및 중복 데이터를 필터링(`distinct`, `exclude`) 처리
        
2. **비동기 요청 큐 도입**
    - API 요청을 병렬 처리(`aiohttp`)로 변경해 응답 누락 최소화

**결과:**

- 영화 데이터 누락률 12% → **1% 이하로 감소**
- OTT 추천 정확도 개선 (평균 추천 일치율 85%)

---

### 🧩 문제 2: ChatGPT 기반 추천 응답의 일관성 부족

**상황:**

사용자가 같은 장르를 선택해도, ChatGPT가 매번 다른 영화 리스트를 반환하여

추천 결과가 들쭉날쭉하게 표시됨.

**원인:**

- ChatGPT 모델의 확률적 응답 특성
- 입력 프롬프트 설계가 일관되지 않음

**해결 방법:**

1. **시스템 프롬프트 고정 템플릿 설계**
    - “한국어로, 3개의 영화만, JSON 배열로 출력” 등 구조적 요청 방식 도입
2. **응답 캐싱 구조 추가**
    - 동일 장르 요청 시 이전 응답을 DB에 저장하여 재사용

**결과:**

- 추천 일관성 향상 (동일 장르 재요청 시 동일 결과율 **95% 유지**)
- ChatGPT API 호출 비용 40% 절감

---

### 🔐 문제 3: OAuth2 로그인 후 세션 만료 처리 누락

**상황:**

카카오 로그인 후 브라우저 쿠키에 세션이 남아

사용자가 로그아웃을 눌러도 즉시 로그아웃되지 않는 현상 발생.

**원인:**

- Django 세션 미삭제
- 카카오 OAuth2 로그아웃 URL 호출 누락

**해결 방법:**

1. **프론트엔드에서 카카오 로그아웃 API 직접 호출**
    
    ```jsx
    window.Kakao.Auth.logout(() => {
      document.cookie = 'sessionid=; expires=Thu, 01 Jan 1970 00:00:00 UTC;';
    });
    
    ```
    
2. **서버 측 세션 정리 로직 추가**
    - Django에서 `logout(request)` 시 쿠키 삭제 및 세션 만료 처리

**결과:**

- 세션 유지 문제 100% 해결
- 로그인/로그아웃 안정성 확보

---

### ⚙️ 문제 4: Vue-Django 간 CORS 및 데이터 직렬화 오류

**상황:**

Vue 프론트엔드에서 Django API 호출 시 CORS 에러와 JSON 직렬화 오류가 빈번히 발생.

**원인:**

- Django REST Framework의 `SAFE_METHODS` 설정 누락
- Vue에서 axios 기본 헤더(`application/json`) 미설정

**해결 방법:**

1. **CORS 헤더 설정 보완**
    - Django에 `django-cors-headers` 모듈 적용
2. **Axios 글로벌 설정 추가**
    
    ```jsx
    axios.defaults.headers.common['Content-Type'] = 'application/json';
    
    ```
    

**결과:**

- CORS 오류 0건
- API 응답 성공률 100%

---

### **6. 프로젝트 성과 및 결과**

- **성과:**
    - 짧은 개발 기간 내 프로젝트 기획부터 구현까지 완료.
    - OAuth2, OpenAPI, ChatGPT 등의 기술을 성공적으로 통합.
- **결과:**사용자가 원하는 OTT 플랫폼을 손쉽게 찾을 수 있는 서비스를 구현하여 사용자 편의성을 극대화.