# 미션 알람 서비스 깻냥 프로젝트

기간 및 인원: 2024.06 ~ 2024.07 (인원 6명)
기술스택: Flutter, JavaScript, React, Spring Boot
담당역할: 팀원, FrontEnd 개발, 네이티브 기능 개발
프로젝트 개요: WebRTC및 모바일 네이티브 기능으로 미션알람 서비스를 제공하는 프로젝트입니다.

![Group 16.png](https://assets.cvcvcx9.org/images/kkatnyang/aefa2422-7b2f-4494-851c-1ba49be8c6bd.png)

<aside className='mt-2'>
>💡
영상통화로 상대방이 미션을 수행하는지 확인하고, 투표하세요! 혼자서 진행하는 경우에는 AI가 직접 성공과 실패를 판정합니다.

</aside>

[https://youtube.com/shorts/potFdbd8nD8?feature=share](https://youtube.com/shorts/potFdbd8nD8?feature=share)

### **1. 프로젝트 개요**

- **목표:**
    
    스마트폰으로 미션을 수행하고, 팀과 함께 실시간으로 공유하며, 투표를 통해 미션 결과를 평가하여 사용자가 목표 시간에 꼭 일어나도록 돕는 앱 개발.
    
- **배경:**
    
    기상 알람이 효과적이지 않거나 의지가 부족한 사람들을 위해, 팀원들과 함께 미션을 수행하며 상호 격려와 평가를 통해 아침 일어나는 습관을 형성할 수 있도록 기획된 프로젝트.
    
- **주요 기능:**
    - 매일 아침 집에서 수행 가능한 미션 자동 선정.
    - 실시간 단체 영상 통화를 통한 미션 진행 공유 및 확인.
    - 팀원들이 미션 결과를 투표로 판정.
    - 미션 시간이 되면 알림 제공.

---

### **2. 담당 역할 및 기여**

- **역할:**
    
    프론트엔드 개발.
    
- **기여:**
    - **OAuth2.0 로그인 구현:** 사용자 인증 및 로그인 프로세스 개발.
    - **노티 기능 개발:** 미션 시작 및 초대 알림 구현.
    - **친구 초대 및 관리:** 사용자 초대 및 초대된 친구 관리 기능 개발.
    - **WebRTC 기반 미션 방 접속:** 실시간 영상 통화 및 미션 방 접속 기능 구현.
    - **미션 시간 조정 기능:** 사용자 맞춤형 미션 시간 설정 지원.
    - **네이티브 알람 구현:** 안드로이드 네이티브 알람 기능을 활용해 미션 시간 알림 제공.

---

### **3. 사용 기술 및 이유**

- **사용 기술:**
    - **React:** 웹 및 모바일 인터페이스 구축에 활용.
    - **Flutter:** 크로스 플랫폼 개발을 통해 빠른 빌드와 원활한 개발 지원.
    - **FCM (Firebase Cloud Messaging):** 푸시 알림 기능 구현.
    - **안드로이드 네이티브 알람:** 미션 알람 제공 및 시간 관리 지원.
- **선택 이유:**
    - `Openvidu`에서 공식적으로 제공하는 튜토리얼이 `React`기반으로 되어있어 빠른 적용을 위해 `React` 와 같이 사용하기로 결정
    - Firebase와 안드로이드 네이티브 기능은 알림 및 시간 기반 이벤트 구현에 최적화되어 있어 효율적인 개발이 가능.

---

### **4. 구현 사항**

- **미션 수행 및 방 참여:**미션 수행 시간이 되면 사용자는 미션 방에 접속하여 진행할 미션을 선택.
- **미션 진행 확인 및 투표:**실시간 영상 통화를 통해 팀원이 어떤 미션을 수행 중인지 확인하고, 투표를 통해 성공 여부를 평가.
- **네이티브 알람 및 푸시 알림:**
    - 네이티브 알람을 통해 미션 시작 시간을 사용자에게 알림.
    - FCM을 활용한 푸시 알림으로 초대 및 진행 상황을 실시간 전달.

### ERD
![깻냥.png](https://assets.cvcvcx9.org/images/kkatnyang/깻냥.png)

---

### **5. 프로젝트 성과 및 결과**

- **성과:**
    - OAuth2.0 및 WebRTC 기술을 성공적으로 적용하여 실시간 미션 수행 환경 제공.
    - React와 Flutter 기반으로 빠른 개발과 사용자 친화적인 인터페이스 구현.
    - FCM 및 네이티브 알람 기능을 통해 사용자 편의성 극대화.
- **결과:**
    
    프로젝트의 모든 주요 기능이 계획에 따라 동작하도록 구현.
    

---

### 6. 문제 및 해결방법

### 🔔 문제 1: 알람이 기기별로 다르게 동작

**상황:**

FCM을 통한 푸시 알림은 정상적으로 오지만,

안드로이드 네이티브 알람은 절전모드·기기별 OS 버전에 따라 실행 누락 발생.

**원인:**

- FCM은 서버 기반이지만, 네이티브 알람은 로컬 스케줄러에 의존
- 일부 제조사(Xiaomi, Samsung 등)는 백그라운드 제한이 심함

**해결 방법:**

1. **AlarmManager + WorkManager 병행 구조 도입**
    - AlarmManager로 기본 알람 설정
    - OS에서 제한 시 WorkManager가 백그라운드 대체 실행
2. **FCM 백업 알림 시스템 추가**
    - 로컬 알람이 실패하면 서버에서 FCM으로 재알림 발송

**결과:**

- 알람 누락률 12% → **0%**
- 기기 환경별 동작 일관성 확보

---

### 🤝 문제 2: 초대 수락 시 세션 동기화 불일치

**상황:**

친구가 초대를 수락했는데, 호스트 화면에는 참여자 정보가 바로 반영되지 않음.

**원인:**

- 초대 수락 이벤트를 실시간으로 반영하지 못함
- 백엔드 DB 반영 후 프론트 상태 업데이트가 지연됨

**해결 방법:**

1. **FCM 데이터 메시지 활용**
    - 초대 수락 시 서버가 모든 클라이언트에 FCM 데이터 메시지를 전송
2. **React 상태관리 개선(zustand)**
    - 초대 상태(`pending → accepted`)를 전역 상태로 즉시 반영

**결과:**

- 세션 반영 지연시간 5초 → **0.5초 이하로 단축**
- 참여 인원 동기화 100% 성공

---

### 🕓 문제 3: 미션 시간 변경 시 알림 스케줄 혼선

**상황:**

사용자가 미션 시간을 변경했을 때,

기존 알람이 취소되지 않아 중복 알림이 발생함.

**원인:**

- 기존 알람을 명시적으로 취소하지 않고 새로운 스케줄을 추가함
- 로컬 DB에 남은 이전 시간 정보가 재등록됨

**해결 방법:**

1. **알람 재등록 시 기존 알람 취소 로직 추가**
    
    ```kotlin
    alarmManager.cancel(pendingIntent)
    
    ```
    
2. **Room DB를 통해 스케줄 상태 관리**
    - 최신 알람 시간만 유지, 중복 등록 방지

**결과:**

- 중복 알림 3건/10회 → **0건**
- 알림 정확도 100% 유지